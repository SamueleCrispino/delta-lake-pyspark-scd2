:: loading settings :: url = jar:file:/opt/spark-3.5.0-bin-hadoop3/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
pyspark version:  3.5.0
Spark Version:  3.5.0
READ_PATH:  /data/crm_with_event_time/header/header_20230228.csv
WRITE_PATH:  /data/delta/landing/header/
AFTER TRANSFORM PHASE:
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|contratto_cod|codice_ordine_sap|tipo_contratto|codice_opec|data_firma|net_amount|causale_annullamento|data_annullamento|codice_agente|status_quote             |creazione_dta|closed_by_batch|source_file        |ingest_ts                 |batch_id                          |valid_from_ts      |valid_to_ts        |is_current|valid_from_year|valid_from_month|valid_from_day|creazione_dta_raw|creazione_dta_parsed|
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|C00000001    |3000013368       |365,366,400   |OPEC0368   |2022-08-03|42499.53  |NULL                |NULL             |10368        |Accepted,Rejected,Pending|2022-07-24   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 00:30:07|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-07-24       |2022-07-24          |
|C00000034    |3000021075       |365,366,400   |OPEC0075   |2022-08-01|31915.98  |NULL                |NULL             |10075        |Accepted,Rejected,Pending|2022-07-22   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 01:51:16|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-07-22       |2022-07-22          |
|C00000079    |3000024937       |NULL          |OPEC0937   |2022-05-31|46566.32  |NULL                |NULL             |10437        |NULL                     |2022-05-14   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 13:16:28|2023-02-28 14:34:23|false     |2023           |2               |28            |2022-05-14       |2022-05-14          |
|C00000079    |3000043499       |NULL          |OPEC0499   |2022-04-01|41060.33  |NULL                |NULL             |10499        |NULL                     |2022-03-04   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 14:34:23|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-03-04       |2022-03-04          |
|C00000091    |3000028716       |365,366,400   |OPEC0716   |2022-06-23|45101.49  |NULL                |NULL             |10216        |Accepted,Rejected,Pending|2022-05-28   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 11:47:36|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-05-28       |2022-05-28          |
|C00000100    |3000007897       |NULL          |OPEC0897   |2023-01-16|36380.39  |NULL                |NULL             |10397        |NULL                     |2023-01-06   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 04:16:39|9999-12-31 00:00:00|true      |2023           |2               |28            |2023-01-06       |2023-01-06          |
|C00000118    |3000040842       |365,366,400   |OPEC0842   |2023-01-02|13605.95  |NULL                |NULL             |10342        |Accepted,Rejected,Pending|2022-12-17   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 12:17:13|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-12-17       |2022-12-17          |
|C00000119    |3000048428       |NULL          |OPEC0428   |2023-02-19|7650.11   |NULL                |NULL             |10428        |NULL                     |2023-02-15   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 01:38:10|9999-12-31 00:00:00|true      |2023           |2               |28            |2023-02-15       |2023-02-15          |
|C00000122    |3000014661       |365,366,400   |OPEC0661   |2022-11-05|38015.74  |NULL                |NULL             |10161        |Accepted,Rejected,Pending|2022-10-09   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 18:32:26|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-10-09       |2022-10-09          |
|C00000134    |3000000058       |NULL          |OPEC0058   |2022-06-05|33555.84  |NULL                |NULL             |10058        |NULL                     |2022-05-24   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 19:37:23|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-05-24       |2022-05-24          |
|C00000145    |3000040281       |365,366,400   |OPEC0281   |2022-10-06|19186.07  |NULL                |NULL             |10281        |Accepted,Rejected,Pending|2022-09-19   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 05:30:39|2023-02-28 13:31:43|false     |2023           |2               |28            |2022-09-19       |2022-09-19          |
|C00000145    |3000030875       |NULL          |OPEC0875   |2022-05-18|34059.05  |NULL                |NULL             |10375        |NULL                     |2022-04-30   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 13:31:43|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-04-30       |2022-04-30          |
|C00000148    |3000034200       |365,366,400   |OPEC0200   |2023-02-15|25965.07  |NULL                |NULL             |10200        |Accepted,Rejected,Pending|2023-01-26   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 19:15:15|9999-12-31 00:00:00|true      |2023           |2               |28            |2023-01-26       |2023-01-26          |
|C00000149    |3000033349       |NULL          |OPEC0349   |2022-05-12|14932.9   |NULL                |NULL             |10349        |NULL                     |2022-05-02   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 13:57:19|2023-02-28 16:44:15|false     |2023           |2               |28            |2022-05-02       |2022-05-02          |
|C00000149    |3000008786       |NULL          |OPEC0786   |2022-12-05|8569.51   |NULL                |NULL             |10286        |NULL                     |2022-11-10   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 16:44:15|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-11-10       |2022-11-10          |
|C00000152    |3000009833       |NULL          |OPEC0833   |2022-12-04|7608.84   |NULL                |NULL             |10333        |NULL                     |2022-11-15   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 10:22:12|2023-02-28 15:07:30|false     |2023           |2               |28            |2022-11-15       |2022-11-15          |
|C00000152    |3000013743       |365,366,400   |OPEC0743   |2023-02-18|4646.97   |NULL                |NULL             |10243        |Accepted,Rejected,Pending|2023-01-25   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 15:07:30|2023-02-28 18:34:12|false     |2023           |2               |28            |2023-01-25       |2023-01-25          |
|C00000152    |3000024689       |NULL          |OPEC0689   |2022-10-10|3710.82   |NULL                |NULL             |10189        |NULL                     |2022-09-22   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 18:34:12|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-09-22       |2022-09-22          |
|C00000164    |3000048746       |NULL          |OPEC0746   |2022-07-09|48218.49  |NULL                |NULL             |10246        |NULL                     |2022-06-21   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 03:58:01|2023-02-28 05:02:17|false     |2023           |2               |28            |2022-06-21       |2022-06-21          |
|C00000164    |3000028643       |NULL          |OPEC0643   |2022-08-08|19230.89  |NULL                |NULL             |10143        |NULL                     |2022-07-09   |NULL           |header_20230228.csv|2025-09-02 07:35:11.367805|20250902073511_header_20230228.csv|2023-02-28 05:02:17|2023-02-28 07:12:22|false     |2023           |2               |28            |2022-07-09       |2022-07-09          |
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
only showing top 20 rows

FOUND DELTA TABLE APPLYING MERGING
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|contratto_cod|codice_ordine_sap|tipo_contratto|codice_opec|data_firma|net_amount|causale_annullamento|data_annullamento|codice_agente|status_quote|creazione_dta|closed_by_batch|source_file        |ingest_ts                 |batch_id                          |valid_from_ts      |valid_to_ts        |is_current|valid_from_year|valid_from_month|valid_from_day|creazione_dta_raw|creazione_dta_parsed|
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|C00594397    |3000594397       |365           |OPEC0397   |2023-01-16|15870.11  |NULL                |NULL             |10397        |Accepted    |2023-01-29   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 17:12:16|2023-02-28 20:55:53|false     |2023           |2               |28            |NULL             |NULL                |
|C00182013    |3000182013       |400           |OPEC0013   |2022-06-18|20342.62  |NULL                |NULL             |10013        |Pending     |2023-02-25   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 15:57:27|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00594397    |3000594397       |365           |OPEC0397   |2023-01-21|2431.53   |NULL                |NULL             |10397        |Rejected    |2023-02-05   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 20:55:53|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00182311    |3000182311       |365           |OPEC0311   |2022-10-29|29263.41  |NULL                |NULL             |10311        |Accepted    |2023-02-12   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 19:53:43|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00594832    |3000594832       |365           |OPEC0832   |2022-06-24|43078.46  |NULL                |NULL             |10332        |Accepted    |2023-02-24   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 07:32:24|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00182611    |3000182611       |366           |OPEC0611   |2022-06-17|35906.76  |NULL                |NULL             |10111        |Accepted    |2023-02-02   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 12:31:33|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00000647    |3000000647       |400           |OPEC0647   |2023-02-18|26233.97  |NULL                |NULL             |10147        |Accepted    |2023-02-25   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 20:50:35|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00182655    |3000182655       |365           |OPEC0655   |2022-06-22|21141.75  |NULL                |NULL             |10155        |Pending     |2023-02-23   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 01:14:09|2023-02-28 15:36:02|false     |2023           |2               |28            |NULL             |NULL                |
|C00000873    |3000000873       |400           |OPEC0873   |2022-05-19|26595.38  |NULL                |NULL             |10373        |Pending     |2023-02-04   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 22:02:27|2023-02-28 22:41:37|false     |2023           |2               |28            |NULL             |NULL                |
|C00182655    |3000182655       |365           |OPEC0655   |2022-06-05|19645.89  |NULL                |NULL             |10155        |Accepted    |2023-01-30   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 15:36:02|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00000873    |3000000873       |365           |OPEC0873   |2023-01-18|11053.96  |NULL                |NULL             |10373        |Rejected    |2023-02-13   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 22:41:37|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00183395    |3000183395       |366           |OPEC0395   |2022-09-16|27578.85  |NULL                |NULL             |10395        |Pending     |2023-02-21   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 10:23:59|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00595142    |3000595142       |400           |OPEC0142   |2022-07-25|14564.92  |NULL                |NULL             |10142        |Accepted    |2023-02-05   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 00:43:21|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00183459    |3000183459       |366           |OPEC0459   |2022-08-01|12605.41  |NULL                |NULL             |10459        |Accepted    |2023-02-09   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 04:58:48|2023-02-28 14:09:37|false     |2023           |2               |28            |NULL             |NULL                |
|C00001044    |3000001044       |365           |OPEC0044   |2022-06-28|39819.79  |NULL                |NULL             |10044        |Pending     |2023-02-22   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 09:40:25|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00183459    |3000183459       |400           |OPEC0459   |2022-05-26|6507.66   |NULL                |NULL             |10459        |Pending     |2023-02-19   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 14:09:37|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00595517    |3000595517       |366           |OPEC0517   |2022-04-18|30146.47  |NULL                |NULL             |10017        |Accepted    |2023-02-25   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 01:56:17|2023-02-28 21:52:30|false     |2023           |2               |28            |NULL             |NULL                |
|C00183537    |3000183537       |365           |OPEC0537   |2023-01-24|31352.45  |NULL                |NULL             |10037        |Accepted    |2023-02-04   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 22:16:50|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00595517    |3000595517       |400           |OPEC0517   |2023-01-19|49835.39  |NULL                |NULL             |10017        |Rejected    |2023-02-24   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 21:52:30|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00184058    |3000184058       |365           |OPEC0058   |2022-03-22|26821.05  |NULL                |NULL             |10058        |Rejected    |2023-02-05   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 22:36:58|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
only showing top 20 rows

inserted_count:  0
closed_count:  74719
MERGE COMPLETATO (intraday versions gestite).
