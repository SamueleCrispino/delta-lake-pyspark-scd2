:: loading settings :: url = jar:file:/opt/spark-3.5.0-bin-hadoop3/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
pyspark version:  3.5.0
Spark Version:  3.5.0
READ_PATH:  /data/crm_with_event_time/header/header_20230127.csv
WRITE_PATH:  /data/delta/landing/header/
AFTER TRANSFORM PHASE:
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|contratto_cod|codice_ordine_sap|tipo_contratto|codice_opec|data_firma|net_amount|causale_annullamento|data_annullamento|codice_agente|status_quote             |creazione_dta|closed_by_batch|source_file        |ingest_ts                 |batch_id                          |valid_from_ts      |valid_to_ts        |is_current|valid_from_year|valid_from_month|valid_from_day|creazione_dta_raw|creazione_dta_parsed|
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|C00000001    |3000000001       |NULL          |OPEC0001   |2022-03-23|43687.91  |NULL                |NULL             |10001        |NULL                     |2022-03-17   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 12:29:39|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-03-17       |2022-03-17          |
|C00000010    |3000000010       |NULL          |OPEC0010   |2022-10-14|16989.47  |NULL                |NULL             |10010        |NULL                     |2022-09-16   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 12:12:23|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-09-16       |2022-09-16          |
|C00000013    |3000000013       |NULL          |OPEC0013   |2022-06-18|34117.66  |NULL                |NULL             |10013        |NULL                     |2022-06-01   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 10:33:56|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-06-01       |2022-06-01          |
|C00000023    |3000000023       |NULL          |OPEC0023   |2022-02-07|42035.15  |NULL                |NULL             |10023        |NULL                     |2022-01-29   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 11:30:54|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-01-29       |2022-01-29          |
|C00000029    |3000000029       |NULL          |OPEC0029   |2022-11-25|3636.63   |NULL                |NULL             |10029        |NULL                     |2022-11-22   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 14:13:47|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-11-22       |2022-11-22          |
|C00000034    |3000000034       |NULL          |OPEC0034   |2022-05-27|38671.08  |NULL                |NULL             |10034        |NULL                     |2022-05-16   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 18:03:14|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-05-16       |2022-05-16          |
|C00000037    |3000000037       |NULL          |OPEC0037   |2022-06-07|8077.62   |NULL                |NULL             |10037        |NULL                     |2022-05-31   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 17:25:47|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-05-31       |2022-05-31          |
|C00000053    |3000000053       |NULL          |OPEC0053   |2022-04-01|6315.74   |NULL                |NULL             |10053        |NULL                     |2022-03-20   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 21:22:01|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-03-20       |2022-03-20          |
|C00000056    |3000000056       |NULL          |OPEC0056   |2022-06-27|30983.47  |NULL                |NULL             |10056        |NULL                     |2022-06-23   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 10:19:12|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-06-23       |2022-06-23          |
|C00000057    |3000000057       |365,366,400   |OPEC0057   |2022-10-31|10051.26  |NULL                |NULL             |10057        |Accepted,Rejected,Pending|2022-10-30   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 17:21:03|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-10-30       |2022-10-30          |
|C00000079    |3000000079       |NULL          |OPEC0079   |2022-11-17|4143.91   |NULL                |NULL             |10079        |NULL                     |2022-11-01   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 17:04:50|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-11-01       |2022-11-01          |
|C00000086    |3000000086       |NULL          |OPEC0086   |2022-04-18|7261.1    |NULL                |NULL             |10086        |NULL                     |2022-04-13   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 00:34:57|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-04-13       |2022-04-13          |
|C00000089    |3000000089       |NULL          |OPEC0089   |2022-09-06|7376.5    |NULL                |NULL             |10089        |NULL                     |2022-08-31   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 22:50:36|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-08-31       |2022-08-31          |
|C00000091    |3000000091       |NULL          |OPEC0091   |2022-11-12|2253.8    |NULL                |NULL             |10091        |NULL                     |2022-10-16   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 05:41:49|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-10-16       |2022-10-16          |
|C00000095    |3000000095       |NULL          |OPEC0095   |2022-08-06|47974.11  |NULL                |NULL             |10095        |NULL                     |2022-08-03   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 11:52:25|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-08-03       |2022-08-03          |
|C00000100    |3000000100       |NULL          |OPEC0100   |2022-12-14|27428.25  |NULL                |NULL             |10100        |NULL                     |2022-12-04   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 11:14:24|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-12-04       |2022-12-04          |
|C00000105    |3000000105       |365,366,400   |OPEC0105   |2022-06-03|19845.87  |NULL                |NULL             |10105        |Accepted,Rejected,Pending|2022-05-16   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 04:10:35|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-05-16       |2022-05-16          |
|C00000118    |3000000118       |NULL          |OPEC0118   |2022-10-29|20036.43  |NULL                |NULL             |10118        |NULL                     |2022-10-14   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 09:53:14|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-10-14       |2022-10-14          |
|C00000119    |3000000119       |NULL          |OPEC0119   |2022-06-29|10571.56  |NULL                |NULL             |10119        |NULL                     |2022-06-05   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 10:05:57|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-06-05       |2022-06-05          |
|C00000122    |3000000122       |NULL          |OPEC0122   |2022-08-03|6320.62   |NULL                |NULL             |10122        |NULL                     |2022-07-25   |NULL           |header_20230127.csv|2025-09-02 07:34:22.931858|20250902073422_header_20230127.csv|2023-01-27 21:10:33|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-07-25       |2022-07-25          |
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
only showing top 20 rows

FOUND DELTA TABLE APPLYING MERGING
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+------------+-------------+----------------------------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|contratto_cod|codice_ordine_sap|tipo_contratto|codice_opec|data_firma|net_amount|causale_annullamento|data_annullamento|codice_agente|status_quote|creazione_dta|closed_by_batch                   |source_file        |ingest_ts                 |batch_id                          |valid_from_ts      |valid_to_ts        |is_current|valid_from_year|valid_from_month|valid_from_day|creazione_dta_raw|creazione_dta_parsed|
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+------------+-------------+----------------------------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|C00000023    |3000000023       |400           |OPEC0023   |2022-05-01|46006.18  |NULL                |NULL             |10023        |Pending     |2023-01-17   |20250902073406_header_20230127.csv|header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 04:31:01|2023-01-27 11:30:54|false     |2023           |1               |27            |2023-01-17       |2023-01-17          |
|C00000122    |3000000122       |366           |OPEC0122   |2022-02-04|47260.39  |NULL                |NULL             |10122        |Pending     |2022-12-31   |20250901174611_header_20230228.csv|header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 16:48:31|2023-02-28 09:27:37|false     |2023           |1               |27            |2022-12-31       |2022-12-31          |
|C00000181    |3000000181       |365           |OPEC0181   |2022-09-14|27292.04  |NULL                |NULL             |10181        |Rejected    |2023-01-16   |NULL                              |header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 11:43:47|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-16       |2023-01-16          |
|C00000382    |3000000382       |400           |OPEC0382   |2022-02-18|19676.58  |NULL                |NULL             |10382        |Pending     |2023-01-17   |20250902073406_header_20230127.csv|header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 10:44:26|2023-01-27 21:29:55|false     |2023           |1               |27            |2023-01-17       |2023-01-17          |
|C00000430    |3000000430       |400           |OPEC0430   |2022-11-19|15721.33  |NULL                |NULL             |10430        |Pending     |2022-12-28   |NULL                              |header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 19:44:12|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-12-28       |2022-12-28          |
|C00000492    |3000000492       |400           |OPEC0492   |2022-02-10|22676.81  |NULL                |NULL             |10492        |Accepted    |2023-01-25   |20250902073406_header_20230127.csv|header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 12:57:06|2023-01-27 20:56:39|false     |2023           |1               |27            |2023-01-25       |2023-01-25          |
|C00000647    |3000000647       |400           |OPEC0647   |2022-12-07|45334.19  |NULL                |NULL             |10147        |Pending     |2023-01-20   |20250901130638_header_20230228.csv|header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 22:29:18|2023-02-28 20:50:35|false     |2023           |1               |27            |2023-01-20       |2023-01-20          |
|C00000687    |3000000687       |365           |OPEC0687   |2022-07-16|8121.01   |NULL                |NULL             |10187        |Pending     |2023-01-26   |20250902073406_header_20230127.csv|header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 02:12:17|2023-01-27 11:20:54|false     |2023           |1               |27            |2023-01-26       |2023-01-26          |
|C00000873    |3000000873       |366           |OPEC0873   |2022-04-19|26052.3   |NULL                |NULL             |10373        |Pending     |2022-12-29   |20250901130638_header_20230228.csv|header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 21:36:09|2023-02-28 22:41:37|false     |2023           |1               |27            |2022-12-29       |2022-12-29          |
|C00000922    |3000000922       |400           |OPEC0922   |2022-05-04|32428.3   |NULL                |NULL             |10422        |Pending     |2023-01-02   |20250902073406_header_20230127.csv|header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 18:02:33|2023-01-27 21:44:09|false     |2023           |1               |27            |2023-01-02       |2023-01-02          |
|C00000946    |3000000946       |400           |OPEC0946   |2022-09-09|17131.22  |NULL                |NULL             |10446        |Rejected    |2023-01-11   |20250902073406_header_20230127.csv|header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 02:13:44|2023-01-27 06:10:20|false     |2023           |1               |27            |2023-01-11       |2023-01-11          |
|C00001142    |3000001142       |366           |OPEC0142   |2022-06-05|44037.55  |NULL                |NULL             |10142        |Accepted    |2023-01-16   |20250902073406_header_20230127.csv|header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 03:10:03|2023-01-27 10:10:22|false     |2023           |1               |27            |2023-01-16       |2023-01-16          |
|C00001147    |3000001147       |365           |OPEC0147   |2023-01-21|7710.52   |NULL                |NULL             |10147        |Rejected    |2023-01-16   |20250901174611_header_20230228.csv|header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 10:49:31|2023-02-28 12:01:48|false     |2023           |1               |27            |2023-01-16       |2023-01-16          |
|C00001149    |3000001149       |400           |OPEC0149   |2022-03-19|34792.99  |NULL                |NULL             |10149        |Pending     |2022-12-31   |20250902073406_header_20230127.csv|header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 05:34:45|2023-01-27 22:15:02|false     |2023           |1               |27            |2022-12-31       |2022-12-31          |
|C00001156    |3000001156       |400           |OPEC0156   |2022-05-10|30065.63  |NULL                |NULL             |10156        |Rejected    |2023-01-24   |20250902073406_header_20230127.csv|header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 00:58:16|2023-01-27 21:24:22|false     |2023           |1               |27            |2023-01-24       |2023-01-24          |
|C00001247    |3000001247       |400           |OPEC0247   |2022-07-22|7479.67   |NULL                |NULL             |10247        |Pending     |2023-01-26   |20250901174611_header_20230228.csv|header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 11:37:11|2023-02-28 18:34:17|false     |2023           |1               |27            |2023-01-26       |2023-01-26          |
|C00001337    |3000001337       |400           |OPEC0337   |2022-05-02|6784.85   |NULL                |NULL             |10337        |Accepted    |2023-01-13   |NULL                              |header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 21:30:02|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-13       |2023-01-13          |
|C00001351    |3000001351       |400           |OPEC0351   |2022-04-30|9807.43   |NULL                |NULL             |10351        |Accepted    |2023-01-19   |20250902073406_header_20230127.csv|header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 02:50:13|2023-01-27 22:09:39|false     |2023           |1               |27            |2023-01-19       |2023-01-19          |
|C00001484    |3000001484       |400           |OPEC0484   |2022-08-18|48923.06  |NULL                |NULL             |10484        |Pending     |2023-01-12   |20250901174611_header_20230228.csv|header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 19:04:21|2023-02-28 04:04:18|false     |2023           |1               |27            |2023-01-12       |2023-01-12          |
|C00001567    |3000001567       |365           |OPEC0567   |2022-12-16|6980.53   |NULL                |NULL             |10067        |Pending     |2023-01-06   |NULL                              |header_20230127.csv|2025-09-01 13:06:22.789861|20250901130622_header_20230127.csv|2023-01-27 02:58:32|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-06       |2023-01-06          |
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+------------+-------------+----------------------------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
only showing top 20 rows

inserted_count:  0
closed_count:  24410
MERGE COMPLETATO (intraday versions gestite).
