:: loading settings :: url = jar:file:/opt/spark-3.5.0-bin-hadoop3/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
pyspark version:  3.5.0
Spark Version:  3.5.0
READ_PATH:  /data/crm_with_event_time/header/header_20230228.csv
WRITE_PATH:  /data/delta/landing/header/
AFTER TRANSFORM PHASE:
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|contratto_cod|codice_ordine_sap|tipo_contratto|codice_opec|data_firma|net_amount|causale_annullamento|data_annullamento|codice_agente|status_quote             |creazione_dta|closed_by_batch|source_file        |ingest_ts                 |batch_id                          |valid_from_ts      |valid_to_ts        |is_current|valid_from_year|valid_from_month|valid_from_day|creazione_dta_raw|creazione_dta_parsed|
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|C00000023    |3000212416       |NULL          |OPEC0416   |2022-05-30|1155.39   |NULL                |NULL             |10416        |NULL                     |2022-05-12   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 15:38:41|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-05-12       |2022-05-12          |
|C00000181    |3004039819       |NULL          |OPEC0819   |2022-05-03|29398.8   |NULL                |NULL             |10319        |NULL                     |2022-04-26   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 07:28:00|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-04-26       |2022-04-26          |
|C00000228    |3002515380       |365,366,400   |OPEC0380   |2022-11-22|43137.75  |NULL                |NULL             |10380        |Accepted,Rejected,Pending|2022-11-12   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 14:23:03|2023-02-28 17:30:06|false     |2023           |2               |28            |2022-11-12       |2022-11-12          |
|C00000228    |3001592860       |NULL          |OPEC0860   |2022-12-23|37849.5   |NULL                |NULL             |10360        |NULL                     |2022-12-16   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 17:30:06|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-12-16       |2022-12-16          |
|C00000284    |3003601231       |NULL          |OPEC0231   |2022-07-26|14291.0   |NULL                |NULL             |10231        |NULL                     |2022-07-01   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 08:38:38|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-07-01       |2022-07-01          |
|C00000297    |3003407768       |NULL          |OPEC0768   |2022-05-16|34314.5   |NULL                |NULL             |10268        |NULL                     |2022-05-04   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 01:55:46|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-05-04       |2022-05-04          |
|C00000393    |3003272902       |NULL          |OPEC0902   |2022-04-25|5597.74   |NULL                |NULL             |10402        |NULL                     |2022-04-25   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 03:08:08|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-04-25       |2022-04-25          |
|C00000416    |3001414560       |365,366,400   |OPEC0560   |2023-02-27|13441.46  |NULL                |NULL             |10060        |Accepted,Rejected,Pending|2023-02-04   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 12:42:21|9999-12-31 00:00:00|true      |2023           |2               |28            |2023-02-04       |2023-02-04          |
|C00000430    |3000186450       |365,366,400   |OPEC0450   |2022-08-12|19112.29  |NULL                |NULL             |10450        |Accepted,Rejected,Pending|2022-07-15   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 09:49:07|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-07-15       |2022-07-15          |
|C00000471    |3003370666       |NULL          |OPEC0666   |2022-08-07|7973.07   |NULL                |NULL             |10166        |NULL                     |2022-07-21   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 15:59:40|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-07-21       |2022-07-21          |
|C00000629    |3001196665       |NULL          |OPEC0665   |2023-01-14|595.84    |NULL                |NULL             |10165        |NULL                     |2023-01-03   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 11:22:07|9999-12-31 00:00:00|true      |2023           |2               |28            |2023-01-03       |2023-01-03          |
|C00000651    |3001485008       |NULL          |OPEC0008   |2022-09-07|31914.85  |NULL                |NULL             |10008        |NULL                     |2022-09-01   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 13:09:53|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-09-01       |2022-09-01          |
|C00000712    |3001785451       |NULL          |OPEC0451   |2022-04-05|10440.09  |NULL                |NULL             |10451        |NULL                     |2022-03-31   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 01:28:25|2023-02-28 16:14:06|false     |2023           |2               |28            |2022-03-31       |2022-03-31          |
|C00000712    |3003034329       |365,366,400   |OPEC0329   |2022-12-19|22269.24  |NULL                |NULL             |10329        |Accepted,Rejected,Pending|2022-11-25   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 16:14:06|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-11-25       |2022-11-25          |
|C00000713    |3000015566       |NULL          |OPEC0566   |2022-05-12|19840.12  |NULL                |NULL             |10066        |NULL                     |2022-04-29   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 13:29:49|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-04-29       |2022-04-29          |
|C00000873    |3002557248       |365,366,400   |OPEC0248   |2022-06-05|47993.6   |NULL                |NULL             |10248        |Accepted,Rejected,Pending|2022-06-05   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 05:17:16|2023-02-28 07:52:07|false     |2023           |2               |28            |2022-06-05       |2022-06-05          |
|C00000873    |3000323084       |NULL          |OPEC0084   |2022-07-28|24442.18  |NULL                |NULL             |10084        |NULL                     |2022-07-08   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 07:52:07|2023-02-28 13:52:55|false     |2023           |2               |28            |2022-07-08       |2022-07-08          |
|C00000873    |3001070220       |365,366,400   |OPEC0220   |2022-12-07|26887.68  |NULL                |NULL             |10220        |Accepted,Rejected,Pending|2022-11-11   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 13:52:55|2023-02-28 17:13:34|false     |2023           |2               |28            |2022-11-11       |2022-11-11          |
|C00000873    |3003821606       |NULL          |OPEC0606   |2022-12-31|10889.18  |NULL                |NULL             |10106        |NULL                     |2022-12-06   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 17:13:34|2023-02-28 21:28:16|false     |2023           |2               |28            |2022-12-06       |2022-12-06          |
|C00000873    |3001087500       |365,366,400   |OPEC0500   |2023-02-07|3470.86   |NULL                |NULL             |10000        |Accepted,Rejected,Pending|2023-01-22   |NULL           |header_20230228.csv|2025-09-02 07:46:53.815114|20250902074653_header_20230228.csv|2023-02-28 21:28:16|9999-12-31 00:00:00|true      |2023           |2               |28            |2023-01-22       |2023-01-22          |
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
only showing top 20 rows

FOUND DELTA TABLE APPLYING MERGING
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+----------------------------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|contratto_cod|codice_ordine_sap|tipo_contratto|codice_opec|data_firma|net_amount|causale_annullamento|data_annullamento|codice_agente|status_quote             |creazione_dta|closed_by_batch                   |source_file        |ingest_ts                 |batch_id                          |valid_from_ts      |valid_to_ts        |is_current|valid_from_year|valid_from_month|valid_from_day|creazione_dta_raw|creazione_dta_parsed|
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+----------------------------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|C00000001    |3000220127       |NULL          |OPEC0127   |2022-07-07|23209.02  |NULL                |NULL             |10127        |NULL                     |2022-07-02   |NULL                              |header_20230228.csv|2025-09-02 07:37:45.376859|20250902073745_header_20230228.csv|2023-02-28 11:46:42|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C04355471    |3002424427       |NULL          |OPEC0427   |2022-04-29|4680.92   |NULL                |NULL             |10427        |NULL                     |2022-04-07   |NULL                              |header_20230228.csv|2025-09-02 07:41:51.883395|20250902074151_header_20230228.csv|2023-02-28 19:24:40|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00000001    |3000013368       |365,366,400   |OPEC0368   |2022-08-03|42499.53  |NULL                |NULL             |10368        |Accepted,Rejected,Pending|2022-07-24   |20250902073704_header_20230228.csv|header_20230228.csv|2025-09-02 07:35:31.056824|20250902073531_header_20230228.csv|2023-02-28 00:30:07|2023-02-28 11:46:42|false     |2023           |2               |28            |NULL             |NULL                |
|C04355471    |3002242180       |NULL          |OPEC0180   |2022-04-02|23932.75  |NULL                |NULL             |10180        |NULL                     |2022-03-16   |NULL                              |header_20230228.csv|2025-09-02 07:41:51.883395|20250902074151_header_20230228.csv|2023-02-28 17:30:23|2023-02-28 19:24:40|false     |2023           |2               |28            |NULL             |NULL                |
|C00000056    |3000057344       |NULL          |OPEC0344   |2022-12-25|4335.75   |NULL                |NULL             |10344        |NULL                     |2022-12-18   |NULL                              |header_20230228.csv|2025-09-02 07:37:45.376859|20250902073745_header_20230228.csv|2023-02-28 15:42:18|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C04355476    |3000194983       |NULL          |OPEC0983   |2022-07-13|11462.87  |NULL                |NULL             |10483        |NULL                     |2022-07-06   |NULL                              |header_20230228.csv|2025-09-02 07:41:51.883395|20250902074151_header_20230228.csv|2023-02-28 08:37:02|2023-02-28 09:17:18|false     |2023           |2               |28            |NULL             |NULL                |
|C00000056    |3002070588       |365,366,400   |OPEC0588   |2023-02-24|25738.77  |NULL                |NULL             |10088        |Accepted,Rejected,Pending|2023-02-19   |NULL                              |header_20230228.csv|2025-09-02 07:41:51.883395|20250902074151_header_20230228.csv|2023-02-28 06:53:40|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C04355476    |3002151264       |365,366,400   |OPEC0264   |2022-04-27|24719.36  |NULL                |NULL             |10264        |Accepted,Rejected,Pending|2022-04-06   |NULL                              |header_20230228.csv|2025-09-02 07:41:51.883395|20250902074151_header_20230228.csv|2023-02-28 09:17:18|2023-02-28 14:24:25|false     |2023           |2               |28            |NULL             |NULL                |
|C00000091    |3001011140       |NULL          |OPEC0140   |2022-10-23|31758.29  |NULL                |NULL             |10140        |NULL                     |2022-09-27   |20250902074632_header_20230228.csv|header_20230228.csv|2025-09-02 07:41:51.883395|20250902074151_header_20230228.csv|2023-02-28 09:52:42|2023-02-28 18:02:51|false     |2023           |2               |28            |NULL             |NULL                |
|C04355476    |3001275860       |NULL          |OPEC0860   |2022-07-21|9290.43   |NULL                |NULL             |10360        |NULL                     |2022-07-18   |NULL                              |header_20230228.csv|2025-09-02 07:41:51.883395|20250902074151_header_20230228.csv|2023-02-28 14:24:25|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00000091    |3000307538       |NULL          |OPEC0538   |2022-03-22|12219.08  |NULL                |NULL             |10038        |NULL                     |2022-03-12   |NULL                              |header_20230228.csv|2025-09-02 07:41:51.883395|20250902074151_header_20230228.csv|2023-02-28 06:29:56|2023-02-28 09:52:42|false     |2023           |2               |28            |NULL             |NULL                |
|C04355549    |3001800044       |NULL          |OPEC0044   |2022-03-19|41159.07  |NULL                |NULL             |10044        |NULL                     |2022-02-24   |NULL                              |header_20230228.csv|2025-09-02 07:41:51.883395|20250902074151_header_20230228.csv|2023-02-28 10:00:32|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00000091    |3000000091       |365           |OPEC0091   |2022-05-27|49759.75  |NULL                |NULL             |10091        |Rejected                 |2023-02-22   |20250902074632_header_20230228.csv|header_20230228.csv|2025-09-01 17:46:41.802387|20250901174641_header_20230228.csv|2023-02-28 12:44:26|2023-02-28 18:02:51|false     |2023           |2               |28            |NULL             |NULL                |
|C04355563    |3000443600       |NULL          |OPEC0600   |2022-11-28|995.38    |NULL                |NULL             |10100        |NULL                     |2022-11-02   |20250902074632_header_20230228.csv|header_20230228.csv|2025-09-02 07:41:51.883395|20250902074151_header_20230228.csv|2023-02-28 13:07:46|2023-02-28 17:42:43|false     |2023           |2               |28            |NULL             |NULL                |
|C00000091    |3000028716       |365,366,400   |OPEC0716   |2022-06-23|45101.49  |NULL                |NULL             |10216        |Accepted,Rejected,Pending|2022-05-28   |20250902074632_header_20230228.csv|header_20230228.csv|2025-09-02 07:35:31.056824|20250902073531_header_20230228.csv|2023-02-28 11:47:36|2023-02-28 18:02:51|false     |2023           |2               |28            |NULL             |NULL                |
|C04355621    |3002326178       |NULL          |OPEC0178   |2023-02-03|24676.33  |NULL                |NULL             |10178        |NULL                     |2023-01-21   |20250902074632_header_20230228.csv|header_20230228.csv|2025-09-02 07:41:51.883395|20250902074151_header_20230228.csv|2023-02-28 12:01:51|2023-02-28 15:47:12|false     |2023           |2               |28            |NULL             |NULL                |
|C00000105    |3000064124       |NULL          |OPEC0124   |2022-11-19|42838.98  |NULL                |NULL             |10124        |NULL                     |2022-11-05   |NULL                              |header_20230228.csv|2025-09-02 07:41:51.883395|20250902074151_header_20230228.csv|2023-02-28 20:07:24|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C04355724    |3001661310       |365,366,400   |OPEC0310   |2022-09-04|8861.49   |NULL                |NULL             |10310        |Accepted,Rejected,Pending|2022-08-11   |NULL                              |header_20230228.csv|2025-09-02 07:41:51.883395|20250902074151_header_20230228.csv|2023-02-28 06:14:53|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00000105    |3000000105       |366           |OPEC0105   |2022-03-01|12813.54  |NULL                |NULL             |10105        |Rejected                 |2023-02-27   |20250902074021_header_20230228.csv|header_20230228.csv|2025-09-01 17:46:41.802387|20250901174641_header_20230228.csv|2023-02-28 15:11:57|2023-02-28 20:07:24|false     |2023           |2               |28            |NULL             |NULL                |
|C04355803    |3001114713       |365,366,400   |OPEC0713   |2022-09-27|7861.17   |NULL                |NULL             |10213        |Accepted,Rejected,Pending|2022-09-16   |NULL                              |header_20230228.csv|2025-09-02 07:41:51.883395|20250902074151_header_20230228.csv|2023-02-28 06:50:23|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+----------------------------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
only showing top 20 rows

inserted_count:  0
closed_count:  5397390
MERGE COMPLETATO (intraday versions gestite).
