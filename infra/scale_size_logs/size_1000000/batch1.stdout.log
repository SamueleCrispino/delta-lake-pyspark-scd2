:: loading settings :: url = jar:file:/opt/spark-3.5.0-bin-hadoop3/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
pyspark version:  3.5.0
Spark Version:  3.5.0
READ_PATH:  /data/crm_with_event_time/header/header_20230127.csv
WRITE_PATH:  /data/delta/landing/header/
AFTER TRANSFORM PHASE:
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|contratto_cod|codice_ordine_sap|tipo_contratto|codice_opec|data_firma|net_amount|causale_annullamento|data_annullamento|codice_agente|status_quote             |creazione_dta|closed_by_batch|source_file        |ingest_ts                 |batch_id                          |valid_from_ts      |valid_to_ts        |is_current|valid_from_year|valid_from_month|valid_from_day|creazione_dta_raw|creazione_dta_parsed|
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|C00000023    |3000000023       |NULL          |OPEC0023   |2022-12-23|16783.73  |NULL                |NULL             |10023        |NULL                     |2022-12-19   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 08:25:04|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-12-19       |2022-12-19          |
|C00000037    |3000000037       |NULL          |OPEC0037   |2022-05-31|26531.98  |NULL                |NULL             |10037        |NULL                     |2022-05-12   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 04:18:09|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-05-12       |2022-05-12          |
|C00000089    |3000000089       |NULL          |OPEC0089   |2022-07-10|13027.03  |NULL                |NULL             |10089        |NULL                     |2022-06-23   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 17:37:11|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-06-23       |2022-06-23          |
|C00000122    |3000000122       |NULL          |OPEC0122   |2022-03-15|35183.13  |NULL                |NULL             |10122        |NULL                     |2022-03-06   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 22:15:30|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-03-06       |2022-03-06          |
|C00000228    |3000000228       |365,366,400   |OPEC0228   |2022-12-18|13804.46  |NULL                |NULL             |10228        |Accepted,Rejected,Pending|2022-12-16   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 10:50:58|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-12-16       |2022-12-16          |
|C00000284    |3000000284       |NULL          |OPEC0284   |2022-07-29|39838.35  |NULL                |NULL             |10284        |NULL                     |2022-07-18   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 02:15:50|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-07-18       |2022-07-18          |
|C00000297    |3000000297       |365,366,400   |OPEC0297   |2022-06-23|13598.77  |NULL                |NULL             |10297        |Accepted,Rejected,Pending|2022-06-02   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 08:18:50|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-06-02       |2022-06-02          |
|C00000382    |3000000382       |NULL          |OPEC0382   |2022-02-03|36556.49  |NULL                |NULL             |10382        |NULL                     |2022-01-27   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 10:02:13|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-01-27       |2022-01-27          |
|C00000393    |3000000393       |365,366,400   |OPEC0393   |2022-09-06|31330.22  |NULL                |NULL             |10393        |Accepted,Rejected,Pending|2022-08-13   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 07:03:28|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-08-13       |2022-08-13          |
|C00000398    |3000000398       |NULL          |OPEC0398   |2022-04-27|401.6     |NULL                |NULL             |10398        |NULL                     |2022-04-10   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 17:55:43|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-04-10       |2022-04-10          |
|C00000416    |3000000416       |NULL          |OPEC0416   |2023-01-23|12971.54  |NULL                |NULL             |10416        |NULL                     |2023-01-19   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 05:44:36|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-19       |2023-01-19          |
|C00000430    |3000000430       |NULL          |OPEC0430   |2022-10-30|18698.29  |NULL                |NULL             |10430        |NULL                     |2022-10-02   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 21:36:16|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-10-02       |2022-10-02          |
|C00000465    |3000000465       |365,366,400   |OPEC0465   |2022-11-29|31291.09  |NULL                |NULL             |10465        |Accepted,Rejected,Pending|2022-11-09   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 02:51:37|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-11-09       |2022-11-09          |
|C00000471    |3000000471       |365,366,400   |OPEC0471   |2022-09-03|17436.52  |NULL                |NULL             |10471        |Accepted,Rejected,Pending|2022-08-16   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 00:32:21|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-08-16       |2022-08-16          |
|C00000492    |3000000492       |365,366,400   |OPEC0492   |2022-05-05|39559.09  |NULL                |NULL             |10492        |Accepted,Rejected,Pending|2022-04-17   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 07:19:07|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-04-17       |2022-04-17          |
|C00000498    |3000000498       |365,366,400   |OPEC0498   |2023-01-20|6122.57   |NULL                |NULL             |10498        |Accepted,Rejected,Pending|2023-01-10   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 07:13:58|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-10       |2023-01-10          |
|C00000502    |3000000502       |NULL          |OPEC0502   |2022-09-30|25101.93  |NULL                |NULL             |10002        |NULL                     |2022-09-30   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 19:06:23|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-09-30       |2022-09-30          |
|C00000622    |3000000622       |NULL          |OPEC0622   |2022-12-18|43961.39  |NULL                |NULL             |10122        |NULL                     |2022-12-02   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 00:38:15|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-12-02       |2022-12-02          |
|C00000629    |3000000629       |NULL          |OPEC0629   |2022-06-07|21261.34  |NULL                |NULL             |10129        |NULL                     |2022-05-16   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 15:05:38|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-05-16       |2022-05-16          |
|C00000647    |3000000647       |NULL          |OPEC0647   |2022-06-26|46258.96  |NULL                |NULL             |10147        |NULL                     |2022-05-28   |NULL           |header_20230127.csv|2025-09-02 07:36:23.655479|20250902073623_header_20230127.csv|2023-01-27 21:18:39|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-05-28       |2022-05-28          |
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
only showing top 20 rows

FOUND DELTA TABLE APPLYING MERGING
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|contratto_cod|codice_ordine_sap|tipo_contratto|codice_opec|data_firma|net_amount|causale_annullamento|data_annullamento|codice_agente|status_quote|creazione_dta|closed_by_batch|source_file        |ingest_ts                 |batch_id                          |valid_from_ts      |valid_to_ts        |is_current|valid_from_year|valid_from_month|valid_from_day|creazione_dta_raw|creazione_dta_parsed|
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|C00594397    |3000594397       |365           |OPEC0397   |2023-01-16|15870.11  |NULL                |NULL             |10397        |Accepted    |2023-01-29   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 17:12:16|2023-02-28 20:55:53|false     |2023           |2               |28            |NULL             |NULL                |
|C00182013    |3000182013       |400           |OPEC0013   |2022-06-18|20342.62  |NULL                |NULL             |10013        |Pending     |2023-02-25   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 15:57:27|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00594397    |3000594397       |365           |OPEC0397   |2023-01-21|2431.53   |NULL                |NULL             |10397        |Rejected    |2023-02-05   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 20:55:53|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00182311    |3000182311       |365           |OPEC0311   |2022-10-29|29263.41  |NULL                |NULL             |10311        |Accepted    |2023-02-12   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 19:53:43|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00594832    |3000594832       |365           |OPEC0832   |2022-06-24|43078.46  |NULL                |NULL             |10332        |Accepted    |2023-02-24   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 07:32:24|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00182611    |3000182611       |366           |OPEC0611   |2022-06-17|35906.76  |NULL                |NULL             |10111        |Accepted    |2023-02-02   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 12:31:33|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00000647    |3000000647       |400           |OPEC0647   |2023-02-18|26233.97  |NULL                |NULL             |10147        |Accepted    |2023-02-25   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 20:50:35|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00182655    |3000182655       |365           |OPEC0655   |2022-06-22|21141.75  |NULL                |NULL             |10155        |Pending     |2023-02-23   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 01:14:09|2023-02-28 15:36:02|false     |2023           |2               |28            |NULL             |NULL                |
|C00000873    |3000000873       |400           |OPEC0873   |2022-05-19|26595.38  |NULL                |NULL             |10373        |Pending     |2023-02-04   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 22:02:27|2023-02-28 22:41:37|false     |2023           |2               |28            |NULL             |NULL                |
|C00182655    |3000182655       |365           |OPEC0655   |2022-06-05|19645.89  |NULL                |NULL             |10155        |Accepted    |2023-01-30   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 15:36:02|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00000873    |3000000873       |365           |OPEC0873   |2023-01-18|11053.96  |NULL                |NULL             |10373        |Rejected    |2023-02-13   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 22:41:37|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00183395    |3000183395       |366           |OPEC0395   |2022-09-16|27578.85  |NULL                |NULL             |10395        |Pending     |2023-02-21   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 10:23:59|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00595142    |3000595142       |400           |OPEC0142   |2022-07-25|14564.92  |NULL                |NULL             |10142        |Accepted    |2023-02-05   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 00:43:21|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00183459    |3000183459       |366           |OPEC0459   |2022-08-01|12605.41  |NULL                |NULL             |10459        |Accepted    |2023-02-09   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 04:58:48|2023-02-28 14:09:37|false     |2023           |2               |28            |NULL             |NULL                |
|C00001044    |3000001044       |365           |OPEC0044   |2022-06-28|39819.79  |NULL                |NULL             |10044        |Pending     |2023-02-22   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 09:40:25|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00183459    |3000183459       |400           |OPEC0459   |2022-05-26|6507.66   |NULL                |NULL             |10459        |Pending     |2023-02-19   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 14:09:37|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00595517    |3000595517       |366           |OPEC0517   |2022-04-18|30146.47  |NULL                |NULL             |10017        |Accepted    |2023-02-25   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 01:56:17|2023-02-28 21:52:30|false     |2023           |2               |28            |NULL             |NULL                |
|C00183537    |3000183537       |365           |OPEC0537   |2023-01-24|31352.45  |NULL                |NULL             |10037        |Accepted    |2023-02-04   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 22:16:50|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00595517    |3000595517       |400           |OPEC0517   |2023-01-19|49835.39  |NULL                |NULL             |10017        |Rejected    |2023-02-24   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 21:52:30|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00184058    |3000184058       |365           |OPEC0058   |2022-03-22|26821.05  |NULL                |NULL             |10058        |Rejected    |2023-02-05   |NULL           |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 22:36:58|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
only showing top 20 rows

inserted_count:  0
closed_count:  330232
MERGE COMPLETATO (intraday versions gestite).
