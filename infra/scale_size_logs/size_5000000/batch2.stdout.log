:: loading settings :: url = jar:file:/opt/spark-3.5.0-bin-hadoop3/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
pyspark version:  3.5.0
Spark Version:  3.5.0
READ_PATH:  /data/crm_with_event_time/header/header_20230228.csv
WRITE_PATH:  /data/delta/landing/header/
AFTER TRANSFORM PHASE:
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|contratto_cod|codice_ordine_sap|tipo_contratto|codice_opec|data_firma|net_amount|causale_annullamento|data_annullamento|codice_agente|status_quote             |creazione_dta|closed_by_batch|source_file        |ingest_ts                 |batch_id                          |valid_from_ts      |valid_to_ts        |is_current|valid_from_year|valid_from_month|valid_from_day|creazione_dta_raw|creazione_dta_parsed|
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|C00000122    |3002480765       |NULL          |OPEC0765   |2022-06-10|22700.24  |NULL                |NULL             |10265        |NULL                     |2022-05-22   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 07:08:09|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-05-22       |2022-05-22          |
|C00000228    |3001704883       |NULL          |OPEC0883   |2022-05-10|40173.55  |NULL                |NULL             |10383        |NULL                     |2022-04-12   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 02:38:43|2023-02-28 09:45:21|false     |2023           |2               |28            |2022-04-12       |2022-04-12          |
|C00000228    |3002120531       |NULL          |OPEC0531   |2022-10-12|47502.54  |NULL                |NULL             |10031        |NULL                     |2022-09-27   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 09:45:21|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-09-27       |2022-09-27          |
|C00000297    |3001586485       |NULL          |OPEC0485   |2022-09-07|39400.75  |NULL                |NULL             |10485        |NULL                     |2022-08-21   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 14:18:51|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-08-21       |2022-08-21          |
|C00000382    |3001809348       |365,366,400   |OPEC0348   |2022-05-06|48892.18  |NULL                |NULL             |10348        |Accepted,Rejected,Pending|2022-05-01   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 11:42:22|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-05-01       |2022-05-01          |
|C00000416    |3002209087       |NULL          |OPEC0087   |2022-12-03|9724.74   |NULL                |NULL             |10087        |NULL                     |2022-11-03   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 08:47:35|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-11-03       |2022-11-03          |
|C00000430    |3000772295       |NULL          |OPEC0295   |2023-01-01|45872.82  |NULL                |NULL             |10295        |NULL                     |2022-12-23   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 20:31:40|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-12-23       |2022-12-23          |
|C00000492    |3001506087       |365,366,400   |OPEC0087   |2022-07-26|2914.43   |NULL                |NULL             |10087        |Accepted,Rejected,Pending|2022-07-01   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 08:47:16|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-07-01       |2022-07-01          |
|C00000651    |3002437306       |NULL          |OPEC0306   |2023-02-11|15405.51  |NULL                |NULL             |10306        |NULL                     |2023-02-08   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 20:14:25|9999-12-31 00:00:00|true      |2023           |2               |28            |2023-02-08       |2023-02-08          |
|C00000922    |3001175506       |NULL          |OPEC0506   |2022-09-19|34815.24  |NULL                |NULL             |10006        |NULL                     |2022-09-10   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 19:25:25|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-09-10       |2022-09-10          |
|C00000939    |3001475999       |NULL          |OPEC0999   |2022-03-25|560.98    |NULL                |NULL             |10499        |NULL                     |2022-03-14   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 19:38:02|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-03-14       |2022-03-14          |
|C00001064    |3001517477       |NULL          |OPEC0477   |2022-03-11|24408.73  |NULL                |NULL             |10477        |NULL                     |2022-03-05   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 10:15:51|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-03-05       |2022-03-05          |
|C00001114    |3002263238       |NULL          |OPEC0238   |2022-06-10|39006.54  |NULL                |NULL             |10238        |NULL                     |2022-05-26   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 10:14:37|2023-02-28 16:12:31|false     |2023           |2               |28            |2022-05-26       |2022-05-26          |
|C00001114    |3001976691       |365,366,400   |OPEC0691   |2022-08-16|42782.41  |NULL                |NULL             |10191        |Accepted,Rejected,Pending|2022-07-18   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 16:12:31|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-07-18       |2022-07-18          |
|C00001147    |3001477242       |365,366,400   |OPEC0242   |2022-03-09|28965.64  |NULL                |NULL             |10242        |Accepted,Rejected,Pending|2022-03-08   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 19:33:35|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-03-08       |2022-03-08          |
|C00001156    |3001341467       |NULL          |OPEC0467   |2022-08-15|13526.37  |NULL                |NULL             |10467        |NULL                     |2022-08-13   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 04:11:19|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-08-13       |2022-08-13          |
|C00001258    |3000645346       |NULL          |OPEC0346   |2022-10-10|36089.19  |NULL                |NULL             |10346        |NULL                     |2022-10-04   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 02:18:07|2023-02-28 17:23:32|false     |2023           |2               |28            |2022-10-04       |2022-10-04          |
|C00001258    |3000840880       |NULL          |OPEC0880   |2022-11-13|13191.97  |NULL                |NULL             |10380        |NULL                     |2022-11-12   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 17:23:32|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-11-12       |2022-11-12          |
|C00001351    |3000397154       |NULL          |OPEC0154   |2022-04-21|29869.61  |NULL                |NULL             |10154        |NULL                     |2022-03-26   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 21:08:28|9999-12-31 00:00:00|true      |2023           |2               |28            |2022-03-26       |2022-03-26          |
|C00001509    |3000520574       |NULL          |OPEC0574   |2023-01-19|19703.13  |NULL                |NULL             |10074        |NULL                     |2023-01-19   |NULL           |header_20230228.csv|2025-09-02 07:40:39.717229|20250902074039_header_20230228.csv|2023-02-28 09:21:24|9999-12-31 00:00:00|true      |2023           |2               |28            |2023-01-19       |2023-01-19          |
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
only showing top 20 rows

FOUND DELTA TABLE APPLYING MERGING
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+----------------------------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|contratto_cod|codice_ordine_sap|tipo_contratto|codice_opec|data_firma|net_amount|causale_annullamento|data_annullamento|codice_agente|status_quote             |creazione_dta|closed_by_batch                   |source_file        |ingest_ts                 |batch_id                          |valid_from_ts      |valid_to_ts        |is_current|valid_from_year|valid_from_month|valid_from_day|creazione_dta_raw|creazione_dta_parsed|
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+----------------------------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|C00000001    |3000220127       |NULL          |OPEC0127   |2022-07-07|23209.02  |NULL                |NULL             |10127        |NULL                     |2022-07-02   |NULL                              |header_20230228.csv|2025-09-02 07:37:45.376859|20250902073745_header_20230228.csv|2023-02-28 11:46:42|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00002550    |3000029875       |NULL          |OPEC0875   |2022-11-21|45635.98  |NULL                |NULL             |10375        |NULL                     |2022-10-27   |NULL                              |header_20230228.csv|2025-09-02 07:35:31.056824|20250902073531_header_20230228.csv|2023-02-28 09:30:49|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00000001    |3000013368       |365,366,400   |OPEC0368   |2022-08-03|42499.53  |NULL                |NULL             |10368        |Accepted,Rejected,Pending|2022-07-24   |20250902073704_header_20230228.csv|header_20230228.csv|2025-09-02 07:35:31.056824|20250902073531_header_20230228.csv|2023-02-28 00:30:07|2023-02-28 11:46:42|false     |2023           |2               |28            |NULL             |NULL                |
|C00002593    |3000394446       |365,366,400   |OPEC0446   |2022-04-07|11262.72  |NULL                |NULL             |10446        |Accepted,Rejected,Pending|2022-03-10   |NULL                              |header_20230228.csv|2025-09-02 07:37:45.376859|20250902073745_header_20230228.csv|2023-02-28 03:59:22|2023-02-28 16:27:24|false     |2023           |2               |28            |NULL             |NULL                |
|C00000056    |3000057344       |NULL          |OPEC0344   |2022-12-25|4335.75   |NULL                |NULL             |10344        |NULL                     |2022-12-18   |NULL                              |header_20230228.csv|2025-09-02 07:37:45.376859|20250902073745_header_20230228.csv|2023-02-28 15:42:18|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00002593    |3000292070       |NULL          |OPEC0070   |2022-11-11|2938.62   |NULL                |NULL             |10070        |NULL                     |2022-10-30   |NULL                              |header_20230228.csv|2025-09-02 07:37:45.376859|20250902073745_header_20230228.csv|2023-02-28 16:27:24|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00000091    |3000000091       |365           |OPEC0091   |2022-05-27|49759.75  |NULL                |NULL             |10091        |Rejected                 |2023-02-22   |NULL                              |header_20230228.csv|2025-09-01 17:46:41.802387|20250901174641_header_20230228.csv|2023-02-28 12:44:26|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00002670    |3000002670       |365           |OPEC0670   |2022-03-10|32891.01  |NULL                |NULL             |10170        |Pending                  |2023-02-07   |NULL                              |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 03:39:15|2023-02-28 18:37:48|false     |2023           |2               |28            |NULL             |NULL                |
|C00000091    |3000028716       |365,366,400   |OPEC0716   |2022-06-23|45101.49  |NULL                |NULL             |10216        |Accepted,Rejected,Pending|2022-05-28   |NULL                              |header_20230228.csv|2025-09-02 07:35:31.056824|20250902073531_header_20230228.csv|2023-02-28 11:47:36|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00002670    |3000002670       |400           |OPEC0670   |2022-06-06|3800.59   |NULL                |NULL             |10170        |Pending                  |2023-02-09   |NULL                              |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 18:37:48|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00000105    |3000000105       |366           |OPEC0105   |2022-03-01|12813.54  |NULL                |NULL             |10105        |Rejected                 |2023-02-27   |20250902074021_header_20230228.csv|header_20230228.csv|2025-09-01 17:46:41.802387|20250901174641_header_20230228.csv|2023-02-28 15:11:57|2023-02-28 20:07:24|false     |2023           |2               |28            |NULL             |NULL                |
|C00002682    |3000002682       |366           |OPEC0682   |2022-07-23|37787.59  |NULL                |NULL             |10182        |Accepted                 |2023-02-12   |NULL                              |header_20230228.csv|2025-09-01 13:07:24.645281|20250901130724_header_20230228.csv|2023-02-28 02:27:20|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00000119    |3000191762       |NULL          |OPEC0762   |2022-05-07|4539.24   |NULL                |NULL             |10262        |NULL                     |2022-04-22   |NULL                              |header_20230228.csv|2025-09-02 07:37:45.376859|20250902073745_header_20230228.csv|2023-02-28 18:26:50|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00002682    |3000038624       |NULL          |OPEC0624   |2022-07-23|36176.77  |NULL                |NULL             |10124        |NULL                     |2022-07-10   |NULL                              |header_20230228.csv|2025-09-02 07:35:31.056824|20250902073531_header_20230228.csv|2023-02-28 00:28:01|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00000119    |3000000119       |400           |OPEC0119   |2023-02-11|28008.12  |NULL                |NULL             |10119        |Accepted                 |2023-02-22   |20250902073704_header_20230228.csv|header_20230228.csv|2025-09-01 17:46:41.802387|20250901174641_header_20230228.csv|2023-02-28 14:55:49|2023-02-28 18:26:50|false     |2023           |2               |28            |NULL             |NULL                |
|C00002824    |3000289581       |365,366,400   |OPEC0581   |2022-05-26|14794.07  |NULL                |NULL             |10081        |Accepted,Rejected,Pending|2022-05-05   |NULL                              |header_20230228.csv|2025-09-02 07:37:45.376859|20250902073745_header_20230228.csv|2023-02-28 12:02:44|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00000119    |3000048428       |NULL          |OPEC0428   |2023-02-19|7650.11   |NULL                |NULL             |10428        |NULL                     |2023-02-15   |20250902073704_header_20230228.csv|header_20230228.csv|2025-09-02 07:35:31.056824|20250902073531_header_20230228.csv|2023-02-28 01:38:10|2023-02-28 18:26:50|false     |2023           |2               |28            |NULL             |NULL                |
|C00002824    |3000002824       |400           |OPEC0824   |2022-03-10|46431.07  |NULL                |NULL             |10324        |Rejected                 |2023-02-02   |NULL                              |header_20230228.csv|2025-09-01 17:46:41.802387|20250901174641_header_20230228.csv|2023-02-28 01:10:40|2023-02-28 04:37:12|false     |2023           |2               |28            |NULL             |NULL                |
|C00000162    |3000336236       |NULL          |OPEC0236   |2023-01-07|34515.48  |NULL                |NULL             |10236        |NULL                     |2022-12-10   |NULL                              |header_20230228.csv|2025-09-02 07:37:45.376859|20250902073745_header_20230228.csv|2023-02-28 18:24:39|9999-12-31 00:00:00|true      |2023           |2               |28            |NULL             |NULL                |
|C00002824    |3000002824       |365           |OPEC0824   |2023-02-06|22739.88  |NULL                |NULL             |10324        |Accepted                 |2023-02-01   |20250902073455_header_20230228.csv|header_20230228.csv|2025-09-01 17:46:41.802387|20250901174641_header_20230228.csv|2023-02-28 04:37:12|2023-02-28 10:26:57|false     |2023           |2               |28            |NULL             |NULL                |
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+-------------------------+-------------+----------------------------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
only showing top 20 rows

inserted_count:  0
closed_count:  2380668
MERGE COMPLETATO (intraday versions gestite).
