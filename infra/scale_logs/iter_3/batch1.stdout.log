:: loading settings :: url = jar:file:/opt/spark-3.5.0-bin-hadoop3/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
pyspark version:  3.5.0
Spark Version:  3.5.0
READ_PATH:  /data/crm_with_event_time/header/header_20230127.csv
WRITE_PATH:  /data/delta/landing/header/
AFTER TRANSFORM PHASE:
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|contratto_cod|codice_ordine_sap|tipo_contratto|codice_opec|data_firma|net_amount|causale_annullamento|data_annullamento|codice_agente|status_quote|creazione_dta|closed_by_batch|source_file        |ingest_ts                 |batch_id                          |valid_from_ts      |valid_to_ts        |is_current|valid_from_year|valid_from_month|valid_from_day|creazione_dta_raw|creazione_dta_parsed|
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
|C00000001    |3000000001       |400           |OPEC0001   |2022-04-23|5260.0    |NULL                |NULL             |10001        |Rejected    |2023-01-26   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 02:01:05|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-26       |2023-01-26          |
|C00000003    |3000000003       |400           |OPEC0003   |2022-06-27|11801.59  |NULL                |NULL             |10003        |Pending     |2023-01-19   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 21:51:55|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-19       |2023-01-19          |
|C00000005    |3000000005       |365           |OPEC0005   |2022-12-11|19616.44  |NULL                |NULL             |10005        |Rejected    |2022-12-31   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 09:22:38|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-12-31       |2022-12-31          |
|C00000007    |3000000007       |400           |OPEC0007   |2022-07-26|29290.26  |NULL                |NULL             |10007        |Pending     |2023-01-25   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 19:02:42|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-25       |2023-01-25          |
|C00000008    |3000000008       |366           |OPEC0008   |2022-12-18|42910.57  |NULL                |NULL             |10008        |Accepted    |2023-01-15   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 06:17:29|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-15       |2023-01-15          |
|C00000017    |3000000017       |365           |OPEC0017   |2022-11-10|31744.86  |NULL                |NULL             |10017        |Pending     |2023-01-14   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 00:38:04|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-14       |2023-01-14          |
|C00000020    |3000000020       |366           |OPEC0020   |2022-12-01|15381.51  |NULL                |NULL             |10020        |Accepted    |2023-01-13   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 19:00:46|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-13       |2023-01-13          |
|C00000023    |3000000023       |400           |OPEC0023   |2022-05-01|46006.18  |NULL                |NULL             |10023        |Pending     |2023-01-17   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 04:31:01|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-17       |2023-01-17          |
|C00000025    |3000000025       |400           |OPEC0025   |2022-05-24|40985.14  |NULL                |NULL             |10025        |Pending     |2023-01-03   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 01:08:08|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-03       |2023-01-03          |
|C00000028    |3000000028       |366           |OPEC0028   |2022-05-08|23122.82  |NULL                |NULL             |10028        |Accepted    |2023-01-20   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 10:04:21|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-20       |2023-01-20          |
|C00000041    |3000000041       |366           |OPEC0041   |2022-11-09|10305.0   |NULL                |NULL             |10041        |Accepted    |2022-12-28   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 21:03:37|9999-12-31 00:00:00|true      |2023           |1               |27            |2022-12-28       |2022-12-28          |
|C00000046    |3000000046       |400           |OPEC0046   |2022-05-05|16502.12  |NULL                |NULL             |10046        |Rejected    |2023-01-21   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 17:42:45|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-21       |2023-01-21          |
|C00000048    |3000000048       |365           |OPEC0048   |2023-01-23|23455.99  |NULL                |NULL             |10048        |Pending     |2023-01-24   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 09:04:34|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-24       |2023-01-24          |
|C00000051    |3000000051       |400           |OPEC0051   |2023-01-23|33725.3   |NULL                |NULL             |10051        |Pending     |2023-01-18   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 19:59:42|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-18       |2023-01-18          |
|C00000056    |3000000056       |366           |OPEC0056   |2022-04-20|35577.7   |NULL                |NULL             |10056        |Pending     |2023-01-27   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 22:07:04|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-27       |2023-01-27          |
|C00000064    |3000000064       |365           |OPEC0064   |2023-01-15|33341.63  |NULL                |NULL             |10064        |Rejected    |2023-01-17   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 06:17:55|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-17       |2023-01-17          |
|C00000067    |3000000067       |365           |OPEC0067   |2022-03-28|22293.62  |NULL                |NULL             |10067        |Pending     |2023-01-02   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 00:20:27|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-02       |2023-01-02          |
|C00000080    |3000000080       |366           |OPEC0080   |2022-03-11|29207.87  |NULL                |NULL             |10080        |Pending     |2023-01-05   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 13:24:31|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-05       |2023-01-05          |
|C00000082    |3000000082       |366           |OPEC0082   |2022-10-07|9618.45   |NULL                |NULL             |10082        |Pending     |2023-01-11   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 02:29:03|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-11       |2023-01-11          |
|C00000083    |3000000083       |365           |OPEC0083   |2022-11-26|23366.63  |NULL                |NULL             |10083        |Rejected    |2023-01-06   |NULL           |header_20230127.csv|2025-09-01 13:06:18.395216|20250901130618_header_20230127.csv|2023-01-27 16:33:35|9999-12-31 00:00:00|true      |2023           |1               |27            |2023-01-06       |2023-01-06          |
+-------------+-----------------+--------------+-----------+----------+----------+--------------------+-----------------+-------------+------------+-------------+---------------+-------------------+--------------------------+----------------------------------+-------------------+-------------------+----------+---------------+----------------+--------------+-----------------+--------------------+
only showing top 20 rows

INIT DELTA TABLE
